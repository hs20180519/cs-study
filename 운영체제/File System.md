## 00. 파일과 디렉토리
### 파일
- 하드 디스크나 SSD와 같은 보조기억장치에 저장된 정보의 집합
- 파일의 정보에는 이름. 파일을 실행하기 위한 정보, 그리고 파일 관련 부가 정보가 있다.
- 이 부가 정보를 속성 도는 메타 데이터라고 부른다.
- 파일을 다루는 모든 작업은 운영체제에 의해 이뤄진다.
- 운영체제는 파일 생성, 삭제, 열기 등을 위한 시스템 호출을 제공한다.
  

### 디렉토리
- 파일들을 관리하기 위한 특별한 파일(폴더)
- 1단계 디렉터리 : 모든 파일이 하나의 디렉터리 아래에 있는 디렉토리 구조이며 파일들은 서로 유일한 이름을 가진다.
- 트리 구조 디렉터리 : 최상위 디렉토리와 서브 디렉토리가 있다.
- 최상위 디렉터리는 루트 디렉터리라고 부른다.
<img width="653" alt="image" src="https://github.com/user-attachments/assets/1e50453d-fd63-4f34-94ff-28c8c814b47e">

### 경로
경로 : 디렉터리를 이용해 파일 위치, 파일 이름을 특정 짓는 정보
1. 절대경로 : 모든 파일이 가지고 있는 루트 디렉터리에서 자기 자신까지 이르는 고유한 경로
   ex) a.sh의 절대 경로는 /home/minhul/a.sh
2. 상대경로 : 현재 디렉토리부터 시작하는 경로이다.
   ex) 현재 디렉터리 경로가 /home이라면 d.jpg 파일의 상대경로는 guest/d.jpg

### 디렉터리 엔트리
디렉터리는 내부에 해당 디렉터리에 담겨있는 대상과 관련된 정보를 담고 있고, 이는 보조기억장치에 테이블 형태의 정보로 저장된다.   
ex) home 디렉터리의 구성
1. .. (상위 디렉터리)
2. .  (현재 디렉터리)
3. minchul
4. guest

</br>

## 01. 파일 시스템
파일과 디렉터리를 보조기억장치에 저장하고 접근할 수 있게 하는 운영체제 내부 프로그램

</br>

## 02. 파티셔닝과 포매팅
- 파티셔닝 : 저장 장치의 논리적인 영역을 구획하는 작업
- 파티션 : 파티셔닝 작업을 통해 나누어진 영역
- 포매팅 : 파일 시스템을 설정하여 어떤 방식으로 파일을 저장하고 관리할 것인지 결정하고, 새로운 데이터를 쓸 준비를 하는 작업을 의미한다.
파티션마다 다른 파일 시스템을 설정할 수 있다.

</br>

## 03. 파일 할당 방법
운영체제는 파일과 디렉터리를 블록 단위로 읽고 쓴다. 파일을 보조기억장치에 할당하는 방법은 크게 두가지가 있다.   
그리고 불연속 할당에는 연결 할당과 색인 할당이 있다.   
1. 연속 할당
2. 불연속 할당 : 연결 할당 / 색인 할당

### 연속 할당
보조기억장치 내 연속적인 블록에 파일을 할당하는 방식
외부 단편화의 단점이 있다.

<img width="684" alt="image" src="https://github.com/user-attachments/assets/3f51cce2-b290-41ea-a978-3e15553c753b">

### 불연속 할당 - 연결 할당
각 블록 일부에 다음 블록의 주소를 저장하여 각 블록이 다음 블록을 가리키는 형태로 할당하는 방식이다.   
즉, 파일을 이루는 데이터를 연결 리스트로 관리한다.

1. 반드시 첫 번째 블록부터 하나씩 차례대로 읽어야하는 단점이 있다.
2. 하드웨어 고장이나 오류 발생시 해당 블록 이후 블록은 접근할 수 없다.
   
<img width="654" alt="image" src="https://github.com/user-attachments/assets/4b9d9a75-40ee-4cad-8256-15d935745077">
=> + 파일 할당 테이블 => FAT 파일 시스템

### 불연속 할당 - 색인 할당
파일의 모든 블록 주소를 색인 블록이라는 하나의 블록에 모아 관리하는 방식이다.   
디렉토리 엔트리에 파일 이름과 더불어 색인 블록 주소를 명시한다.

<img width="610" alt="image" src="https://github.com/user-attachments/assets/9ed7a3b8-a930-4406-829e-b50398b119fc">   
=> 유닉스 파일 시스템

</br>

## 04. 파일 시스템의 종류
1. FAT 파일 시스템 (FILE ALLOCATION TABLE)
- 파일 속성 정보가 디렉토리 엔트리에 표현되어 있다.
- 연결 할당의 단점을 보완
- 파일 할당 테이블을 이용하여 각 블록에 포함된 다음 블록의 주소들을 한 데 모아 테이블 형태로 관리한다.
- FAT를 메모리에 적재된 채 실행하여 다음 블록을 찾는 속도가 매우 빨라진다.
- 따라서 연결 할당 방식보다 임의 접근에 유리해진다.

/home/minchul/a.sh에 접근할 때, 파일 시스템의 접근 블록 순서
<img width="688" alt="image" src="https://github.com/user-attachments/assets/761ccc4c-4db1-467b-b6e3-57fbd3d8f1d7">

파일시스템은 /home/minchul/a.sh을 읽기 위해 9번, 8번, 11번, 13번 블록에 접근한다.
   
2. 유닉스 파일 시스템
- 유닉스 파일 시스템에서는 색인 블록을 i-node(index-node)라고 부른다,
- i-node에는 파일 속성 정보와 열다섯개의 블록 주소가 저장될 수 있다.
- 파일 속성 정보(파일 크기, 생성 시간, 마지막 접근 시간등)가 i-node에 표현된다.
- i-node의 크기는 유한하여 파일의 블록을 모두 가리킬 수 없는 경우도 존재한다.
  
- (1) 블록 주소 중 열두 개에는 직접 블록 주소를 저장한다.(직접 블록)
- (2) 1번 내용으로 충분하지 않다면 열세번째 주소에 단일 간접 블록 주소를 저장한다. (단일 간접 블록)
<img width="648" alt="image" src="https://github.com/user-attachments/assets/4796d351-b4be-497a-a81e-52cee8863e34">
- (3) 충분하지 않다면 열네번째 주소에 이중 간접 블록 주소 (이중 간접 블록)   
- (4) 충분하지 않다면 열다섯번째 주소에 삼중 간접 블록 주소 (삼중 간접 블록)
- 따라서 유닉스 파일 시스템의 디렉터리 엔트리는 i-node번호와 파일 이름으로 구성된다.

/home/minchul/a.sh에 접근할 때, 유닉스 파일 시스템의 접근 블록 순서
<img width="680" alt="image" src="https://github.com/user-attachments/assets/f72821e8-96a8-496c-aa3f-cd9a8a4c790f">
파일시스템은 /home/minchul/a.sh을 읽기 위해 98번, 12번, 13번 블록에 접근한다.

3. NT 파일 시스템 (NTFS)
4. ext 파일 시스템

</br>

## 05. 저널링 파일 시스템
파일 시스템을 변경하던 중에 "시스템 크래시"가 발생하면 파일 시스템이 훼손될 수 있었다.   
이전에는 부팅 직후 파일 시스템을 검사하고 복구하였으나 시간이 매우 오래 걸린다는 문제가 존재했다.   
=> 저널링 파일 : 작업 로그를 통해 시스템 크래시가 발생했을 때 빠르게 복구하기 위한 방법

1. 작업 직전 파티션의 로그 영역에 수행하는 작업에 대한 로그를 남긴다.
2. 로그를 남긴 후 작업을 수핸한다.
3. 작업이 끝났다면 로그를 삭제한다.

[ 저널링 파일 시스템의 파티션 ]
예약영역 / "로그 영역" / i-node 영역 / 데이터 영역
즉, 저널링 파일 시스템은 시스템 크래시가 발생한 직후에 로그 영역을 읽어 크래시가 발생한 당시 어떤 작업을 실행 중이었는지 알아낸 다음 해당 작업을 완료한다.   

마이크로소프트의 NT 파일 시스템, 리눅스의 ext3, ext4 파일 시스템을 포함하여 현대 대부분의 파일 시스템은 이러한 저널링 기능을 지원한다.

</br>

## 06. 마운트
한 저장장치의 파일 시스템에서 다른 저장 장치의 파일 시스템에 접근할 수 있도록 파일 시스템을 편입시키는 작업   
유닉스, 리눅스와 같은 운영체제에서 다양한 저장 장치를 컴퓨터에 연결할 때 mount 명령어로 빈번하게 마운트한다.

</br>

## Q&A
1. 파일 시스템의 접근 방법은 ? 순차 접근, 직접 접근, 기타 접근
2. 디렉토리 단계 ?
- 1단계 디렉토리(유일한 이름)
- 2단계 디렉토리(사용자 별로 개별적 디렉토리 존재)
- 트리 구조 디렉토리(비트를 활용하여 일반 파일과 디렉토리 파일 구분)
- 그래프 구조 디렉토리(순환이 발생하지 않도록 하위 디렉토리가 아닌 파일에 대한 링크만 허용하거나 가비지 컬렉션을 이용해 전체 파일 시스템을 순회하고 접근 가능한 모든 것을 표시)




