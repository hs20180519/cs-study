# 00. 컴퓨터 시스템의 구성

- 컴퓨터
    - 하드웨어
    - 소프트웨어
        - 응용 프로그램
        - 운영 체제
            - **커널(Kernel)**
            - 시스템 프로그램
            

컴퓨터는 크게 두가지로 구분할 수 있다. 물리적으로 만질 수 있는 **하드웨어**(키보드, 모니터, CPU, 메모리 등)와 물리적으로 존재하지 않는 **소프트웨어**이다.

**소프트웨어**는 다시 **운영체제**(Linux, MacOS, Windows등)와 그 위에 설치되는 프로그램인 **응용 프로그램**(Excel, Chrome)등으로 다시 나눌 수 있다.

그리고 운영체제는 커널(Kernel)과 시스템 프로그램으로 구분한다.     

<br/>

# 01. 커널과 시스템 프로그램

컴퓨터 전원을 키면 운영체제는 이와 동시에 수행되며 메모리에 올라간다. 하지만 운영체제처럼 규모가 큰 프로그램이 모두 메모리에 올라가면 한정된 메모리 공간에서 낭비가 심하다. 따라서 운영체제 중 항상 필요한 부분만을 전원이 켜짐과 동시에 메모리에 올려놓고, 그렇지 않은 부분은 필요할 때 메모리에 올려서 사용하게 된다.

이때 메모리에 상주하는 운영체제의 부분을 커널이라고 한다.

> 커널은 운영체제의 핵심부분으로써 주로 디바이스 관리, 프로세스 관리, 메모리 관리, 시스템 콜 제공등을 통해 컴퓨터 자원을 관리하고, 하드웨어와 응용 프로그램 사이에서 인터페이스를 제공한다.
> 

하지만 커널은 항상 컴퓨터 자원들만 바라보고 있어 사용자와 직접적인 상호작용은 하지 않는다. 그렇기 때문에 사용자와 상호작용을 하기 위해 필요한 것이 **시스템 프로그램(Shell)**이다.

<br/>

# 02. 커널의 역할

커널의 가장 큰 목표는 컴퓨터의 물리적(하드웨어)자원과 추상화 자원을 관리하는 것이다.

![image](https://github.com/user-attachments/assets/74b24a6c-3793-491c-b347-760545d01c27)

추상화된 환경에서는 각 사용자들이 본인이 하나의 하드웨어를 독점하여 활용하는 것처럼 느낄 수 있다. 하지만 물리적 자원인 하드웨어에 접근하기 위한 방법은 매우 복잡하고 어려워 사용자가 직접 접근하기는 무리가 있다.

그렇기 때문에 **물리적 자원을 추상화하여 사용자가 보다 쉽게 접근**할 수 있도록 커널이 필요하다.

<br/>

# 03. 커널의 자원 관리

커널은 물리적 자원과 추상 자원들을 관리한다.

커널을 구성하는 자원 관리자들은 다음과 같다.

리눅스 커널을 구성하는 자원 관리자 :

1. **프로세스 관리자** : 물리적 자원인 CPU 시간, 프로레서 레지스터등을 추상적 자원인 프로세서, 스레드로 제공한다.
    - 프로세스는 독립적인 실행 단위이며, 스레드는 프로세스 내에서 병렬로 실행될 수 있는 작은 실행 단위이다.
2. **메모리 관리자** : 물리적 자원인 메모리(RAM)를 추상적 자원인 가상 메모리, 주소 공간으로 제공한다.
    - 가상 메모리는 물리적 메모리를 추상화한 것으로, 각 프로세스가 자신만의 독립적인 주소 공간을 가질 수 있게 한다.
3. **파일 시스템 관리자** : 물리적 자원인 하드 디스크, SSD 등의 저장 장치 블록을 추상적 자원인 파일, 디렉토리로 제공한다.
4. **장치 관리자** (I/O Manager) : 물리적 자원인 입출력 장치를 추상적 자원인 장치 파일, 인터페이스, 버퍼로 제공한다.
5. **네트워크 관리자** : 물리적 자원인 네트워크 장치, 라우터등을 추상적 자원인 Socket, 포트, 프로토콜 스택으로 제공한다.
6. **보안 관리자** : 물리적 자원인 사용자 계정 데이터베이스등을 추상적 자원인 사용자 계정, 권한으로 제공한다.

이러한 자원 관리자들은 물리적 자원을 추상화하여 사용자가 물리적인 하드웨어에 보다 쉽게 접근하고 사용할 수 있도록 관리한다,

<br/>

# 04. System Call Interface의 역할

![image](https://github.com/user-attachments/assets/364e07f5-76e4-4ba0-8e01-418aece3ed0d)


커널 구성요소들이 존재하는 공간인 **Kernal Space**가 있고, 그 위에는 사용자가 수행하는 작업들이 존재하는 **User Space**가 있다.

이 Kernal Space와 User Space 사이에는 **System Call Interface**가 존재한다.

User space의 task들이 커널이 관리하는 자원에 접근해야 할 필요가 있으면, **System Call Interface**를 통해 커널 스페이스의 자원 관리자에게 요청이 전달된다. 

그리고 이 커널의 각 자원 관리자는 사용자 요청에 맞게 알맞는 하드웨어에 사용자 명령을 전달하고 작업을 수행합니다.

즉, 커널은 사용자가 System call을 통해 컴퓨터 자원을 사용할 수 있게 해주는 자원 관리자이다.

<br/>

# 05. 커널 모드와 유저 모드

CPU는 User application이 시스템을 손상시키는 것을 방지하기 위해 2가지 모드를 제공한다. 

CPU의 Mode bit로 모드를 구분하여 0은 커널 모드(kernal mode), 1은 사용자 모드(user mode)로 나누어서 구동된다. 운영체제에서 프로그램이 구동되는데 있어서 파일을 읽어 오거나, 파일을 쓰거나, 혹은 화면에 메세지를 출력하는 등 많은 부분이 커널 모드를 사용한다.

![image](https://github.com/user-attachments/assets/6c9909c6-e317-4eef-b458-efb7138d9bcc)

1. 사용자 모드(코드 영역, 데이터영역, 스택 및 힙 영역) : 하드웨어에 접근할 수 없어, 시스템 콜을 사용하여 커널에 접근한다.
2. 커널 모드 : 운영체제(OS)가 CPU를 사용하는 모드이다. 시스템 콜을 통해 커널모드로 저널이 되며 운영 체제는 하드웨어를 제어하는 명령어를 실행한다. 모든 하드웨어, 주소 공간에 접근이 가능하며 프로세스 제어, 파일 조작등의 명령을 할 수 있다. 사용자 모드보다 더 높은 권한이 필요하다.
